<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BD Locadora de Ve√≠culos - Diagrama ER Completo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.1/mermaid.min.js"></script>
    <style>
        :root {
            --bg: #0f1117;
            --surface: #1a1d27;
            --surface2: #232733;
            --border: #2d3348;
            --text: #e0e4f0;
            --text-muted: #8b92ab;
            --accent: #7c5cff;
            --accent2: #5b9aff;
            --green: #3dd68c;
            --orange: #f5a524;
            --red: #f54e4e;
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.7;
        }
        .header {
            background: linear-gradient(135deg, #1e1040 0%, #0d1b3e 50%, #0a2020 100%);
            padding: 48px 40px;
            border-bottom: 1px solid var(--border);
        }
        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }
        .header p { color: var(--text-muted); font-size: 1.05rem; }
        .badge-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 16px; }
        .badge {
            display: inline-flex; align-items: center; gap: 6px;
            padding: 4px 14px; border-radius: 20px; font-size: 0.82rem; font-weight: 600;
            border: 1px solid var(--border); background: var(--surface);
        }
        .badge.purple { border-color: var(--accent); color: var(--accent); }
        .badge.blue { border-color: var(--accent2); color: var(--accent2); }
        .badge.green { border-color: var(--green); color: var(--green); }
        .badge.orange { border-color: var(--orange); color: var(--orange); }

        .container { max-width: 1400px; margin: 0 auto; padding: 32px 24px; }

        .section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 24px;
        }
        .section h2 {
            font-size: 1.35rem;
            margin-bottom: 16px;
            color: var(--accent2);
            display: flex; align-items: center; gap: 10px;
        }
        .section h3 { font-size: 1.1rem; margin: 20px 0 10px; color: var(--green); }

        .diagram-container {
            background: #fff;
            border-radius: 12px;
            padding: 24px;
            overflow-x: auto;
            margin: 20px 0;
        }
        .diagram-container .mermaid { min-width: 2400px; }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
            font-size: 0.9rem;
        }
        th {
            background: var(--surface2);
            text-align: left;
            padding: 10px 14px;
            font-weight: 600;
            color: var(--accent2);
            border-bottom: 2px solid var(--border);
        }
        td {
            padding: 8px 14px;
            border-bottom: 1px solid var(--border);
            color: var(--text-muted);
        }
        tr:hover td { background: rgba(124,92,255,0.05); color: var(--text); }
        .pk { color: var(--orange); font-weight: 600; }
        .fk { color: var(--accent); font-weight: 600; }
        .uk { color: var(--green); font-weight: 600; }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin: 16px 0;
        }
        .card {
            background: var(--surface2);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 20px;
        }
        .card h4 {
            font-size: 1rem;
            margin-bottom: 6px;
            color: var(--text);
        }
        .card p { font-size: 0.88rem; color: var(--text-muted); }
        .card .card-badge {
            display: inline-block;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .card .card-badge.entity { background: rgba(124,92,255,0.15); color: var(--accent); }
        .card .card-badge.relation { background: rgba(91,154,255,0.15); color: var(--accent2); }
        .card .card-badge.assoc { background: rgba(61,214,140,0.15); color: var(--green); }

        .concept-box {
            background: var(--surface2);
            border-left: 4px solid var(--accent);
            padding: 16px 20px;
            border-radius: 0 8px 8px 0;
            margin: 16px 0;
        }
        .concept-box.green { border-left-color: var(--green); }
        .concept-box.orange { border-left-color: var(--orange); }
        .concept-box strong { color: var(--text); }

        .stats-row {
            display: flex; gap: 16px; flex-wrap: wrap; margin: 16px 0;
        }
        .stat {
            background: var(--surface2);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 16px 24px;
            text-align: center;
            flex: 1; min-width: 140px;
        }
        .stat .number {
            font-size: 2rem; font-weight: 800;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .stat .label { font-size: 0.82rem; color: var(--text-muted); margin-top: 4px; }

        .norm-table td:first-child { font-weight: 600; color: var(--text); white-space: nowrap; }

        @media (max-width: 768px) {
            .header { padding: 24px 16px; }
            .header h1 { font-size: 1.4rem; }
            .section { padding: 20px 16px; }
        }
    </style>
</head>
<body>

<div class="header">
    <h1>üöó Sistema de Banco de Dados ‚Äî Locadora de Ve√≠culos (Brasil 2026)</h1>
    <p>Modelagem conceitual completa com Diagrama ER/MER, normaliza√ß√£o, cardinalidade expl√≠cita e todos os atributos para opera√ß√£o real no mercado brasileiro.</p>
    <div class="badge-row">
        <span class="badge purple">üìê MER Estendido</span>
        <span class="badge blue">üîó Cardinalidade (min, max)</span>
        <span class="badge green">‚úÖ 3FN + BCNF</span>
        <span class="badge orange">üáßüá∑ Legisla√ß√£o Brasileira 2026</span>
    </div>
</div>

<div class="container">

    <!-- ESTAT√çSTICAS -->
    <div class="stats-row">
        <div class="stat"><div class="number">28</div><div class="label">Entidades / Tabelas</div></div>
        <div class="stat"><div class="number">45+</div><div class="label">Relacionamentos</div></div>
        <div class="stat"><div class="number">380+</div><div class="label">Atributos</div></div>
        <div class="stat"><div class="number">3FN</div><div class="label">Normaliza√ß√£o</div></div>
        <div class="stat"><div class="number">4</div><div class="label">Conceitos MER</div></div>
    </div>

    <!-- CONCEITOS APLICADOS -->
    <div class="section">
        <h2>üìö Conceitos do Modelo ER/MER Aplicados</h2>

        <div class="concept-box">
            <strong>Generaliza√ß√£o / Especializa√ß√£o (MER)</strong><br>
            A entidade <strong>PESSOA</strong> √© a superclasse que se especializa em <strong>CLIENTE</strong> e <strong>FUNCION√ÅRIO</strong> (abordagem top-down). Ambos herdam atributos comuns (nome, CPF, email, endere√ßo) e possuem atributos espec√≠ficos. O discriminador √© o campo <code>tipo_pessoa</code>.
        </div>

        <div class="concept-box green">
            <strong>Tipos de Atributos</strong><br>
            <strong>Simples:</strong> nome, CPF, placa ‚Äî <strong>Composto:</strong> ENDERE√áO separado em logradouro, n√∫mero, bairro, cidade, UF ‚Äî <strong>Multivalorado:</strong> telefone_principal e telefone_secund√°rio (poderia ser tabela separada) ‚Äî <strong>Derivado:</strong> km_rodados (km_devolu√ß√£o - km_sa√≠da), dias_utilizados, valor_total.
        </div>

        <div class="concept-box orange">
            <strong>Relacionamentos com Cardinalidade (m√≠n, m√°x)</strong><br>
            <strong>1:1</strong> ‚Äî PESSOA ‚Üî CNH (cada pessoa possui no m√°ximo 1 CNH) | 
            <strong>1:N</strong> ‚Äî CLIENTE ‚Üî CONTRATO (um cliente faz v√°rios contratos) | 
            <strong>N:M</strong> ‚Äî CONTRATO ‚Üî ACESS√ìRIO (via tabela CONTRATO_ACESSORIO) e CONTRATO ‚Üî PROTE√á√ÉO (via CONTRATO_PROTECAO).
        </div>
    </div>

    <!-- DIAGRAMA MERMAID -->
    <div class="section">
        <h2>üìä Diagrama Entidade-Relacionamento Completo</h2>
        <p style="color:var(--text-muted); margin-bottom:16px; font-size:0.92rem;">Role horizontalmente para visualizar o diagrama completo. Cada entidade exibe seus atributos com indica√ß√£o de PK (chave prim√°ria), FK (chave estrangeira) e UK (chave √∫nica).</p>

        <div class="diagram-container">
            <pre class="mermaid">
erDiagram

    PESSOA {
        int pessoa_id PK
        varchar nome_completo
        varchar cpf UK
        varchar rg
        date data_nascimento
        varchar sexo
        varchar email UK
        varchar telefone_principal
        varchar telefone_secundario
        varchar nacionalidade
        varchar tipo_pessoa
        boolean ativo
    }

    ENDERECO {
        int endereco_id PK
        int pessoa_id FK
        varchar cep
        varchar logradouro
        varchar numero
        varchar complemento
        varchar bairro
        varchar cidade
        varchar uf
        varchar tipo_endereco
        boolean endereco_principal
    }

    CLIENTE {
        int cliente_id PK
        int pessoa_id FK
        varchar tipo_cliente
        varchar cnpj UK
        varchar razao_social
        varchar segmento
        int pontos_fidelidade
        date data_cadastro
        varchar status
        varchar origem_cadastro
    }

    FUNCIONARIO {
        int funcionario_id PK
        int pessoa_id FK
        int filial_id FK
        int cargo_id FK
        varchar matricula UK
        date data_admissao
        decimal salario_base
        varchar turno
        varchar nivel_acesso
        varchar status
    }

    CARGO {
        int cargo_id PK
        varchar nome_cargo
        varchar departamento
        decimal piso_salarial
        decimal teto_salarial
    }

    CNH {
        int cnh_id PK
        int pessoa_id FK
        varchar numero_registro UK
        varchar categoria
        date data_validade
        varchar orgao_emissor
        varchar status
    }

    FILIAL {
        int filial_id PK
        varchar cnpj UK
        varchar nome_fantasia
        varchar tipo_filial
        varchar cidade
        varchar uf
        decimal latitude
        decimal longitude
        boolean opera_24h
        int gerente_id FK
        varchar status
    }

    CATEGORIA_VEICULO {
        int categoria_id PK
        varchar nome
        decimal diaria_base
        decimal valor_km_excedente
        int numero_passageiros
        varchar cambio
        boolean ativo
    }

    MARCA {
        int marca_id PK
        varchar nome
        varchar pais_origem
        boolean ativo
    }

    MODELO {
        int modelo_id PK
        int marca_id FK
        int categoria_id FK
        varchar nome
        varchar versao
        varchar combustivel
        varchar cambio
        int portas
        decimal potencia_cv
    }

    VEICULO {
        int veiculo_id PK
        int modelo_id FK
        int filial_atual_id FK
        varchar placa UK
        varchar renavam UK
        varchar chassi UK
        int ano_fabricacao
        varchar cor
        decimal km_atual
        decimal valor_fipe
        date data_aquisicao
        boolean possui_rastreador
        varchar status
    }

    ACESSORIO {
        int acessorio_id PK
        varchar nome
        decimal valor_diaria
        varchar tipo
        boolean ativo
    }

    ACESSORIO_VEICULO {
        int acessorio_veiculo_id PK
        int veiculo_id FK
        int acessorio_id FK
        date data_instalacao
    }

    RESERVA {
        int reserva_id PK
        int cliente_id FK
        int categoria_id FK
        int filial_retirada_id FK
        int filial_devolucao_id FK
        varchar codigo_reserva UK
        datetime data_hora_retirada_prevista
        datetime data_hora_devolucao_prevista
        varchar canal_reserva
        decimal valor_estimado
        varchar status
    }

    CONTRATO {
        int contrato_id PK
        int cliente_id FK
        int veiculo_id FK
        int reserva_id FK
        int filial_retirada_id FK
        int func_abertura_id FK
        varchar numero_contrato UK
        varchar tipo_contrato
        datetime data_hora_retirada
        datetime data_hora_devolucao_real
        decimal km_saida
        decimal km_devolucao
        varchar nivel_combustivel_saida
        varchar nivel_combustivel_devolucao
        decimal valor_total
        varchar status
    }

    CONDUTOR_ADICIONAL {
        int condutor_adicional_id PK
        int contrato_id FK
        int pessoa_id FK
        varchar parentesco
        decimal valor_cobrado
    }

    CONTRATO_ACESSORIO {
        int contrato_acessorio_id PK
        int contrato_id FK
        int acessorio_id FK
        int quantidade
        decimal valor_total
    }

    PROTECAO {
        int protecao_id PK
        varchar nome
        varchar tipo
        decimal valor_diaria
        decimal franquia
        boolean cobre_terceiros
        boolean cobre_roubo_furto
        boolean ativo
    }

    CONTRATO_PROTECAO {
        int contrato_protecao_id PK
        int contrato_id FK
        int protecao_id FK
        decimal valor_diaria
        decimal valor_total
    }

    VISTORIA {
        int vistoria_id PK
        int contrato_id FK
        int veiculo_id FK
        int funcionario_id FK
        varchar tipo_vistoria
        decimal km_registrado
        varchar nivel_combustivel
        varchar resultado
    }

    AVARIA {
        int avaria_id PK
        int vistoria_id FK
        varchar localizacao
        varchar tipo_avaria
        varchar gravidade
        boolean preexistente
        decimal valor_reparo_estimado
    }

    PAGAMENTO {
        int pagamento_id PK
        int contrato_id FK
        int cliente_id FK
        varchar tipo_pagamento
        varchar forma_pagamento
        int parcelas
        decimal valor
        varchar nsu
        datetime data_hora_pagamento
        varchar status
    }

    NOTA_FISCAL {
        int nf_id PK
        int contrato_id FK
        int filial_id FK
        varchar numero_nf UK
        varchar chave_acesso UK
        decimal valor_total
        varchar status
    }

    MULTA {
        int multa_id PK
        int contrato_id FK
        int veiculo_id FK
        int cliente_id FK
        varchar auto_infracao
        varchar gravidade
        decimal valor_original
        varchar status
    }

    MANUTENCAO {
        int manutencao_id PK
        int veiculo_id FK
        int filial_id FK
        int fornecedor_id FK
        varchar tipo
        date data_entrada
        decimal custo_total
        varchar status
    }

    FORNECEDOR {
        int fornecedor_id PK
        varchar cnpj UK
        varchar razao_social
        varchar tipo
        varchar cidade
        boolean ativo
    }

    SINISTRO {
        int sinistro_id PK
        int contrato_id FK
        int veiculo_id FK
        int cliente_id FK
        varchar tipo
        varchar numero_bo
        decimal valor_estimado_dano
        varchar status
    }

    TABELA_PRECO {
        int tabela_preco_id PK
        int categoria_id FK
        int filial_id FK
        varchar tipo_periodo
        date data_inicio
        date data_fim
        decimal valor_diaria
        decimal valor_mensal
        boolean ativo
    }

    PROGRAMA_FIDELIDADE {
        int programa_id PK
        varchar nome
        varchar nivel
        int pontos_minimos
        decimal desconto_percentual
        boolean upgrade_gratuito
    }

    MOVIMENTACAO_PONTOS {
        int movimentacao_id PK
        int cliente_id FK
        int contrato_id FK
        varchar tipo
        int pontos
        int saldo_posterior
        datetime data_hora
    }

    TRANSFERENCIA_VEICULO {
        int transferencia_id PK
        int veiculo_id FK
        int filial_origem_id FK
        int filial_destino_id FK
        int func_motorista_id FK
        datetime data_hora_saida
        decimal km_saida
        varchar status
    }

    PARCEIRO {
        int parceiro_id PK
        varchar cnpj UK
        varchar nome_fantasia
        varchar tipo
        decimal percentual_desconto
        varchar codigo_convenio UK
        varchar status
    }

    LOG_AUDITORIA {
        int log_id PK
        int funcionario_id FK
        varchar tabela_afetada
        varchar acao
        text dados_anteriores
        text dados_novos
        datetime data_hora
    }

    %% Relacionamentos
    PESSOA ||--o| CLIENTE : "especializa"
    PESSOA ||--o| FUNCIONARIO : "especializa"
    PESSOA ||--o{ ENDERECO : "possui"
    PESSOA ||--o| CNH : "possui"
    FILIAL ||--o{ FUNCIONARIO : "lotado em"
    CARGO ||--o{ FUNCIONARIO : "exerce"
    MARCA ||--o{ MODELO : "fabrica"
    CATEGORIA_VEICULO ||--o{ MODELO : "pertence"
    MODELO ||--o{ VEICULO : "instancia"
    FILIAL ||--o{ VEICULO : "estacionado"
    VEICULO ||--o{ ACESSORIO_VEICULO : "possui"
    ACESSORIO ||--o{ ACESSORIO_VEICULO : "instalado"
    CLIENTE ||--o{ RESERVA : "realiza"
    CATEGORIA_VEICULO ||--o{ RESERVA : "solicitada"
    FILIAL ||--o{ RESERVA : "retirada em"
    CLIENTE ||--o{ CONTRATO : "firma"
    VEICULO ||--o{ CONTRATO : "locado"
    RESERVA ||--o| CONTRATO : "origina"
    FILIAL ||--o{ CONTRATO : "retirada"
    FUNCIONARIO ||--o{ CONTRATO : "abre"
    CONTRATO ||--o{ CONDUTOR_ADICIONAL : "inclui"
    PESSOA ||--o{ CONDUTOR_ADICIONAL : "atua como"
    CONTRATO ||--o{ CONTRATO_ACESSORIO : "contrata"
    ACESSORIO ||--o{ CONTRATO_ACESSORIO : "fornecido"
    CONTRATO ||--o{ CONTRATO_PROTECAO : "contrata"
    PROTECAO ||--o{ CONTRATO_PROTECAO : "aplicada"
    CONTRATO ||--|{ VISTORIA : "inspecionado"
    VEICULO ||--o{ VISTORIA : "vistoriado"
    FUNCIONARIO ||--o{ VISTORIA : "realiza"
    VISTORIA ||--o{ AVARIA : "registra"
    CONTRATO ||--|{ PAGAMENTO : "gera"
    CLIENTE ||--o{ PAGAMENTO : "efetua"
    CONTRATO ||--o{ NOTA_FISCAL : "fatura"
    FILIAL ||--o{ NOTA_FISCAL : "emite"
    CONTRATO ||--o{ MULTA : "gera"
    VEICULO ||--o{ MULTA : "recebe"
    VEICULO ||--o{ MANUTENCAO : "passa por"
    FORNECEDOR ||--o{ MANUTENCAO : "executa"
    CONTRATO ||--o{ SINISTRO : "sofre"
    VEICULO ||--o{ SINISTRO : "envolvido"
    CATEGORIA_VEICULO ||--o{ TABELA_PRECO : "precificada"
    FILIAL ||--o{ TABELA_PRECO : "aplica"
    CLIENTE ||--o{ MOVIMENTACAO_PONTOS : "acumula"
    VEICULO ||--o{ TRANSFERENCIA_VEICULO : "transferido"
    FUNCIONARIO ||--o{ LOG_AUDITORIA : "registra"
            </pre>
        </div>
    </div>

    <!-- MAPEAMENTO DE ENTIDADES -->
    <div class="section">
        <h2>üóÇÔ∏è Mapeamento das 28 Entidades por M√≥dulo</h2>
        <div class="card-grid">
            <div class="card">
                <span class="card-badge entity">N√öCLEO - PESSOAS</span>
                <h4>Cadastro Base</h4>
                <p>PESSOA (superclasse), CLIENTE (especializa√ß√£o PF/PJ), FUNCION√ÅRIO (especializa√ß√£o), CNH, ENDERE√áO, CARGO</p>
            </div>
            <div class="card">
                <span class="card-badge entity">FROTA</span>
                <h4>Ve√≠culos e Categorias</h4>
                <p>MARCA, MODELO, CATEGORIA_VEICULO, VEICULO, ACESSORIO, ACESSORIO_VEICULO</p>
            </div>
            <div class="card">
                <span class="card-badge relation">OPERA√á√ÉO</span>
                <h4>Loca√ß√£o</h4>
                <p>RESERVA, CONTRATO, CONDUTOR_ADICIONAL, CONTRATO_ACESSORIO, PROTECAO, CONTRATO_PROTECAO, VISTORIA, AVARIA</p>
            </div>
            <div class="card">
                <span class="card-badge assoc">FINANCEIRO</span>
                <h4>Pagamentos e Fiscal</h4>
                <p>PAGAMENTO, NOTA_FISCAL, MULTA, TABELA_PRECO</p>
            </div>
            <div class="card">
                <span class="card-badge entity">SUPORTE</span>
                <h4>Manuten√ß√£o e Sinistros</h4>
                <p>MANUTENCAO, FORNECEDOR, SINISTRO</p>
            </div>
            <div class="card">
                <span class="card-badge relation">GEST√ÉO</span>
                <h4>Operacional</h4>
                <p>FILIAL, TRANSFERENCIA_VEICULO, PROGRAMA_FIDELIDADE, MOVIMENTACAO_PONTOS, PARCEIRO, LOG_AUDITORIA</p>
            </div>
        </div>
    </div>

    <!-- CARDINALIDADE -->
    <div class="section">
        <h2>üîó Cardinalidade Expl√≠cita dos Relacionamentos</h2>
        <table>
            <thead>
                <tr><th>Entidade A</th><th>Tipo</th><th>Entidade B</th><th>Min:Max (A)</th><th>Min:Max (B)</th><th>Descri√ß√£o</th></tr>
            </thead>
            <tbody>
                <tr><td>PESSOA</td><td class="pk">1:1</td><td>CLIENTE</td><td>(1,1)</td><td>(0,1)</td><td>Pessoa pode ser ou n√£o cliente</td></tr>
                <tr><td>PESSOA</td><td class="pk">1:1</td><td>FUNCION√ÅRIO</td><td>(1,1)</td><td>(0,1)</td><td>Pessoa pode ser ou n√£o funcion√°rio</td></tr>
                <tr><td>PESSOA</td><td class="pk">1:1</td><td>CNH</td><td>(1,1)</td><td>(0,1)</td><td>Nem toda pessoa tem CNH cadastrada</td></tr>
                <tr><td>PESSOA</td><td class="fk">1:N</td><td>ENDERE√áO</td><td>(1,1)</td><td>(1,N)</td><td>Pessoa tem 1 ou mais endere√ßos</td></tr>
                <tr><td>FILIAL</td><td class="fk">1:N</td><td>FUNCION√ÅRIO</td><td>(1,1)</td><td>(0,N)</td><td>Cada funcion√°rio lotado em 1 filial</td></tr>
                <tr><td>MARCA</td><td class="fk">1:N</td><td>MODELO</td><td>(1,1)</td><td>(1,N)</td><td>Marca tem v√°rios modelos</td></tr>
                <tr><td>MODELO</td><td class="fk">1:N</td><td>VE√çCULO</td><td>(1,1)</td><td>(0,N)</td><td>Modelo instanciado em ve√≠culos</td></tr>
                <tr><td>CLIENTE</td><td class="fk">1:N</td><td>CONTRATO</td><td>(1,1)</td><td>(0,N)</td><td>Cliente pode fazer N contratos</td></tr>
                <tr><td>VE√çCULO</td><td class="fk">1:N</td><td>CONTRATO</td><td>(1,1)</td><td>(0,N)</td><td>Ve√≠culo em N contratos ao longo do tempo</td></tr>
                <tr><td>CONTRATO</td><td class="fk">1:N</td><td>PAGAMENTO</td><td>(1,1)</td><td>(1,N)</td><td>Todo contrato gera ao menos 1 pagamento</td></tr>
                <tr><td>CONTRATO</td><td class="uk">N:M</td><td>ACESS√ìRIO</td><td>(0,N)</td><td>(0,N)</td><td>Via tabela CONTRATO_ACESSORIO</td></tr>
                <tr><td>CONTRATO</td><td class="uk">N:M</td><td>PROTE√á√ÉO</td><td>(0,N)</td><td>(0,N)</td><td>Via tabela CONTRATO_PROTECAO</td></tr>
                <tr><td>CONTRATO</td><td class="fk">1:N</td><td>VISTORIA</td><td>(1,1)</td><td>(2,2)</td><td>Exatamente 2: retirada e devolu√ß√£o</td></tr>
                <tr><td>VISTORIA</td><td class="fk">1:N</td><td>AVARIA</td><td>(1,1)</td><td>(0,N)</td><td>Vistoria pode registrar N avarias</td></tr>
                <tr><td>VE√çCULO</td><td class="fk">1:N</td><td>MANUTEN√á√ÉO</td><td>(1,1)</td><td>(0,N)</td><td>Ve√≠culo passa por N manuten√ß√µes</td></tr>
                <tr><td>CATEGORIA</td><td class="fk">1:N</td><td>TABELA_PRE√áO</td><td>(1,1)</td><td>(1,N)</td><td>Pre√ßos por categoria e per√≠odo</td></tr>
                <tr><td>CLIENTE</td><td class="fk">1:N</td><td>MOV_PONTOS</td><td>(1,1)</td><td>(0,N)</td><td>Movimenta√ß√µes de fidelidade</td></tr>
            </tbody>
        </table>
    </div>

    <!-- NORMALIZA√á√ÉO -->
    <div class="section">
        <h2>‚úÖ Normaliza√ß√£o Aplicada</h2>

        <table class="norm-table">
            <thead>
                <tr><th>Forma Normal</th><th>Aplica√ß√£o no Projeto</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td>1FN</td>
                    <td>Todos os atributos s√£o at√¥micos. Endere√ßo foi decomposto em logradouro, n√∫mero, complemento, bairro, cidade, UF e CEP. Telefones separados em principal e secund√°rio. Nenhum grupo repetitivo dentro de uma mesma coluna.</td>
                </tr>
                <tr>
                    <td>2FN</td>
                    <td>Todos os atributos n√£o-chave dependem totalmente da chave prim√°ria. As tabelas associativas (CONTRATO_ACESSORIO, CONTRATO_PROTECAO, ACESSORIO_VEICULO) eliminam depend√™ncias parciais em chaves compostas, cada uma com sua PK surrogate.</td>
                </tr>
                <tr>
                    <td>3FN</td>
                    <td>Elimina√ß√£o de depend√™ncias transitivas. Exemplo: dados da marca n√£o ficam em MODELO (tabela MARCA separada), dados do cargo n√£o ficam em FUNCION√ÅRIO (tabela CARGO separada), dados do fornecedor separados de MANUTEN√á√ÉO.</td>
                </tr>
                <tr>
                    <td>BCNF</td>
                    <td>Toda depend√™ncia funcional X‚ÜíY tem X como superchave. CPF, CNPJ, placa, RENAVAM e chassi s√£o constraints UNIQUE independentes da PK surrogate, garantindo integridade sem violar BCNF.</td>
                </tr>
            </tbody>
        </table>

        <h3>Exemplos Concretos de Normaliza√ß√£o</h3>

        <div class="concept-box">
            <strong>Antes (desnormalizado):</strong> CONTRATO continha nome_cliente, cpf_cliente, nome_veiculo, placa ‚Äî tudo redundante.<br>
            <strong>Depois (3FN):</strong> CONTRATO referencia cliente_id ‚Üí CLIENTE ‚Üí PESSOA (nome, CPF) e veiculo_id ‚Üí VEICULO (placa) ‚Üí MODELO (nome).
        </div>

        <div class="concept-box green">
            <strong>Tabelas Associativas (N:M ‚Üí 1:N + N:1):</strong><br>
            CONTRATO ‚Üî ACESS√ìRIO resolvido via CONTRATO_ACESSORIO com atributos pr√≥prios (quantidade, valor_total).<br>
            CONTRATO ‚Üî PROTE√á√ÉO resolvido via CONTRATO_PROTECAO com atributos pr√≥prios (valor_diaria, valor_total).
        </div>
    </div>

    <!-- REQUISITOS BRASIL -->
    <div class="section">
        <h2>üáßüá∑ Requisitos Espec√≠ficos do Mercado Brasileiro (2026)</h2>
        <div class="card-grid">
            <div class="card">
                <span class="card-badge entity">DOCUMENTOS</span>
                <h4>Documenta√ß√£o Legal</h4>
                <p>CPF, RG, CNH com categoria e validade, RENAVAM, Chassi (padr√£o 17 chars), Placa Mercosul (ABC1D23), CTPS, PIS/PASEP para funcion√°rios.</p>
            </div>
            <div class="card">
                <span class="card-badge relation">FISCAL</span>
                <h4>Obriga√ß√µes Fiscais</h4>
                <p>NFS-e com chave de acesso (44 d√≠gitos), ISS sobre loca√ß√£o de ve√≠culos, CNPJ por filial, Inscri√ß√£o Estadual, IPVA e licenciamento por ve√≠culo.</p>
            </div>
            <div class="card">
                <span class="card-badge assoc">TR√ÇNSITO</span>
                <h4>CTB e DETRAN</h4>
                <p>Controle de multas com auto de infra√ß√£o, pontua√ß√£o CNH, gravidade (leve/m√©dia/grave/grav√≠ssima), transfer√™ncia de responsabilidade ao condutor.</p>
            </div>
            <div class="card">
                <span class="card-badge entity">SEGURAN√áA</span>
                <h4>Equipamentos Obrigat√≥rios</h4>
                <p>Vistoria com checklist: estepe, macaco, tri√¢ngulo, chave de roda, extintor ‚Äî todos exigidos pelo CTB para circula√ß√£o.</p>
            </div>
            <div class="card">
                <span class="card-badge relation">PAGAMENTO</span>
                <h4>Meios Brasileiros</h4>
                <p>PIX (com ID transa√ß√£o), cart√£o de cr√©dito/d√©bito com NSU, boleto banc√°rio, bandeiras nacionais (Elo). Cau√ß√£o via pr√©-autoriza√ß√£o no cart√£o.</p>
            </div>
            <div class="card">
                <span class="card-badge assoc">VE√çCULOS</span>
                <h4>Tabela FIPE e Combust√≠vel</h4>
                <p>C√≥digo e valor FIPE para cada ve√≠culo, combust√≠vel FLEX (padr√£o brasileiro), ve√≠culos el√©tricos e h√≠bridos para 2026.</p>
            </div>
        </div>
    </div>

    <!-- PONTOS OCULTOS -->
    <div class="section">
        <h2>üîç Pontos Ocultos Identificados (al√©m do enunciado)</h2>
        <table>
            <thead><tr><th>Ponto Oculto</th><th>Entidade(s)</th><th>Justificativa</th></tr></thead>
            <tbody>
                <tr><td>Rede de filiais com tipos variados</td><td>FILIAL</td><td>Localiza/Movida operam em aeroportos, lojas de rua, delivery ‚Äî cada tipo com regras distintas (24h, etc)</td></tr>
                <tr><td>Condutor adicional</td><td>CONDUTOR_ADICIONAL</td><td>Requisito legal: s√≥ condutores cadastrados podem dirigir o ve√≠culo locado</td></tr>
                <tr><td>Vistoria detalhada de entrada/sa√≠da</td><td>VISTORIA, AVARIA</td><td>Checklist completo evita disputas sobre responsabilidade por danos</td></tr>
                <tr><td>Prote√ß√µes e seguros opcionais</td><td>PROTECAO, CONTRATO_PROTECAO</td><td>LDW, CDW, prote√ß√£o de vidros, terceiros ‚Äî produtos financeiros essenciais</td></tr>
                <tr><td>Tabela de pre√ßos din√¢mica</td><td>TABELA_PRECO</td><td>Pre√ßo varia por categoria, filial, sazonalidade (carnaval, r√©veillon, f√©rias)</td></tr>
                <tr><td>Transfer√™ncia entre filiais</td><td>TRANSFERENCIA_VEICULO</td><td>Rebalanceamento da frota entre cidades com demanda assim√©trica</td></tr>
                <tr><td>Programa de fidelidade</td><td>PROGRAMA_FIDELIDADE, MOVIMENTACAO_PONTOS</td><td>Localiza tem programa de pontos; essencial para reten√ß√£o de clientes</td></tr>
                <tr><td>Parceiros e conv√™nios</td><td>PARCEIRO</td><td>Conv√™nios com cias a√©reas, hot√©is, cart√µes ‚Äî descontos corporativos</td></tr>
                <tr><td>Sinistros com B.O.</td><td>SINISTRO</td><td>Gest√£o de acidentes, roubos e furtos com rastreamento de ocorr√™ncia policial</td></tr>
                <tr><td>Manuten√ß√£o com fornecedores</td><td>MANUTENCAO, FORNECEDOR</td><td>Preventiva, corretiva, recalls ‚Äî controle de custo e disponibilidade da frota</td></tr>
                <tr><td>Multas de tr√¢nsito</td><td>MULTA</td><td>Transfer√™ncia de responsabilidade ao cliente, controle de prazos</td></tr>
                <tr><td>NFS-e e compliance fiscal</td><td>NOTA_FISCAL</td><td>Obrigat√≥rio no Brasil: chave de acesso, XML, al√≠quota ISS</td></tr>
                <tr><td>Rastreador GPS</td><td>VEICULO (campos)</td><td>Seguran√ßa patrimonial e recupera√ß√£o em caso de roubo/furto</td></tr>
                <tr><td>Log de auditoria</td><td>LOG_AUDITORIA</td><td>LGPD e compliance: rastreabilidade de quem alterou o qu√™ e quando</td></tr>
                <tr><td>Cliente PJ (corporativo)</td><td>CLIENTE (campos CNPJ)</td><td>Grande parte da receita vem de frotas corporativas</td></tr>
            </tbody>
        </table>
    </div>

</div>

<script>
    mermaid.initialize({
        startOnLoad: true,
        theme: 'default',
        er: {
            diagramPadding: 30,
            layoutDirection: 'TB',
            minEntityWidth: 180,
            minEntityHeight: 50,
            entityPadding: 15,
            useMaxWidth: false
        },
        themeVariables: {
            fontSize: '12px'
        }
    });
</script>

</body>
</html>
